function dropdownWithCoins(coin){var baseUrl="/wp-content/themes/arbismart_4.0/assets/icons/coins";var $coin=$('<span><img src="'+baseUrl+'/'+coin.text+'.svg" class="img-coin" /> '+coin.text+'</span>');return $coin;};jQuery(document).ready(function($){function initLabels(){$('[data-label]').each(function(index,element){var label=$(this).data('label');tippy('#'+$(this).attr('id'),{content:label,});});}
function _calc_get_term(currency_id,months_qty,allowed_withdrawal_type){let element=false;$.each(_calculate_data.terms,function(index,term){if(term.currency_id==currency_id&&term.receiver_currency_id==currency_id&&term.months_qty==months_qty&&term.allowed_withdrawal_type==allowed_withdrawal_type){element=term;}else{if(term.currency_id==currency_id&&term.months_qty==months_qty&&term.receiver_currency_id=='RBIS'&&element===false){element=term;}}});return element;}
function _calc_get_terms(currency_id,group_id,number,table='tableCalculate'){var element='<tr> <td><span class="label">Years</span></td> <td id="labelAvaliable" data-label="By choosing this option, your daily interest is sent to an available balance, and is accessible at any time."><span class="label">Profits in '+currency_id+' to Available Balance</span><span class="icon"><span class="icon--info"></span></span></td> <td id="labelLocked" data-label="By choosing this option, your daily interest is locked until the savings period ends."><span class="label">Profits in '+currency_id+' to Locked Balance</span><span class="icon"><span class="icon--info"></span></span></td> <td id="labelRbis" data-label="By choosing this option, your daily interest, paid in RBIS, is locked until the savings period ends."><span class="label">Profits in RBIS to Locked Balance</span><span class="icon"><span class="icon--info"></span></span></td> </tr>';var lang=$('html').attr('lang');if(lang=='de-DE'){var element='<tr> <td><span class="label">Jahre</span></td> <td id="labelAvaliable" data-label="Bei dieser Option werden Ihre täglichen Zinsen auf ein Konto übertragen, auf dem sie jederzeit verfügbar sind."><span class="label">Gewinne in '+currency_id+' bei verfügbarem Guthaben</span><span class="icon"><span class="icon--info"></span></span></td> <td id="labelLocked" data-label="Bei dieser Option sind Ihre Zinsen erst nach Ablauf des Sparplans verfügbar."><span class="label">Gewinne in '+currency_id+' bei nicht verfügbarem Guthaben</span><span class="icon"><span class="icon--info"></span></span></td> <td id="labelRbis" data-label="Bei dieser Option sind Ihre Zinsen, die in RBIS anfallen, erst nach Ablauf des Sparplans verfügbar."><span class="label">Gewinne in RBIS bei nicht verfügbarem Guthaben\n</span><span class="icon"><span class="icon--info"></span></span></td> </tr>';}
let values={};$.each(_calculate_data.terms,function(index,term){if(term.currency_id==currency_id){let total_bonuses=term.bonus_percent[number];if(typeof term.bonus_percent[number]==='undefined'){total_bonuses=0;}
let total_bonus=(total_bonuses+parseFloat(term['interest_percentage']))*12;if(typeof values[term.months_qty]==='undefined'){values[term.months_qty]={};}
if(typeof values[term.months_qty][term.receiver_currency_id]==='undefined'){values[term.months_qty][term.receiver_currency_id]={};}
if(term.receiver_currency_id=='RBIS'&&term.currency_id!=='RBIS'){values[term.months_qty][term.currency_id][3]=total_bonus;}else{values[term.months_qty][term.receiver_currency_id][term.allowed_withdrawal_type]=total_bonus;}}});console.log(values);$.each(values,function(months,coins){$.each(coins,function(coin,percentages){var years=months/12;var available='-',locked='-',rbis='-',caption='';if(coin!==currency_id){}
if(typeof percentages[1]!=='undefined'){if(percentages[1].toString().length>=4){available=percentages[1].toFixed(2)+'% '+caption;}else{available=percentages[1]+'% '+caption;}}
if(typeof percentages[2]!=='undefined'){if(percentages[2].toString().length>=4){locked=percentages[2].toFixed(2)+'% '+caption;}else{locked=percentages[2]+'% '+caption;}}
if(typeof percentages[3]!=='undefined'){rbis=percentages[3]+'% '+caption;}
if(available!=='-'&&locked!=='-'){element=element+'<tr><td><span class="label">'+years+'</span></td>';element=element+'<td><span class="label">'+available+'</span></td>';element=element+'<td><span class="label">'+locked+'</span></td>';element=element+'<td><span class="label">'+rbis+'</span></td>';element=element+'</tr>';}});})
$('#'+table+' tbody').html(element);return element;}
function _calculate_profit(){let profit_currency_id=$('#profit_currency_id').val(),profit_amount=$('#profit_amount').val(),profit_level=$('#profit_level').val(),months_qty=$('#profit_period').val(),allowed_withdrawal_type=$('#profit_lock').val();let term=_calc_get_term(profit_currency_id,months_qty,allowed_withdrawal_type);if(term){let bonus_percent=term.bonus_percent[profit_level];let APY=(bonus_percent+parseFloat(term['interest_percentage']))*12;let total_bonus=(bonus_percent+parseFloat(term['interest_percentage']))*months_qty*(profit_amount/100);var lang=$('html').attr('lang');if(lang=='de-DE'){$('.profit-calculate #profit_result').html('Profitieren: <span id="profit">+'+total_bonus+' '+profit_currency_id+'</span> Gewinne in <span id="period">'+months_qty+'</span> Monate<br> APY = '+APY+'%');}else{$('.profit-calculate #profit_result').html('Profit: <span id="profit">+'+total_bonus+' '+profit_currency_id+'</span> profit in <span id="period">'+months_qty+'</span> months<br> APY = '+APY+'%');}
$('#profit_amount+.caption').html(profit_currency_id);}else{$('.profit-calculate #profit_result').html('Unavailable');}}
function _calculate_table(table='tableCalculate'){let group_id=$('#'+table+' .calculate--select .selected [data-group-id]').data('group-id');let number=$('#'+table+' .calculate--levels .active[data-number]').data('number');let currency_id=$('#'+table+' #currency_id').val();if(table!='tableCalculate'){currency_id=$('#'+table+' #compare_currency_id').val();}
$.each(_calculate_data.accountLevel,function(index,level){if(number==level.number){$('#'+table+' #minimum_rbis').html(level.point.toLocaleString('ru-RU'));}});$('#'+table).attr('class','ui-calculate');$('#'+table).addClass('level--'+number);$('#'+table+' .current--currency img').attr('src','/wp-content/themes/arbismart_4.0/assets/icons/coins/'+currency_id+'.svg');_calc_get_terms(currency_id,group_id,number,table);initLabels();}
$('.profit-calculate select').select2({dropdownAutoWidth:true,});$('#currency_id, #compare_currency_id').select2({placeholder:'Select Currency',dropdownAutoWidth:true,templateResult:dropdownWithCoins,});$('body').on('click','.calculate--select',function(){$(this).toggleClass('open');});$('body').on('click','#tableCalculate .calculate--select > .select-list [data-value]',function(){$('#tableCalculate .calculate--select > .selected').html($(this)[0].outerHTML);$('#tableCalculate > .header.plans').attr('class','header plans').addClass($(this).data('value').toLowerCase());let currentLevel=_levels[$(this).data('group-id')];$('#tableCalculate .calculate--levels').html('<div class="item"> <div class="ui--label active" data-number="'+currentLevel.number+'"> <span class="label">'+currentLevel.label+'</span> </div> </div>');$.each(currentLevel.levels,function(index,element){$('#tableCalculate .calculate--levels').append('<div class="item"> <div class="ui--label" data-number="'+element.number+'"> <span class="label">'+element.label+'</span> </div> </div>');});_calculate_table();});$('body').on('click','#tableCalculateCompare .calculate--select > .select-list [data-value]',function(){$('#tableCalculateCompare .calculate--select > .selected').html($(this)[0].outerHTML);$('#tableCalculateCompare > .header.plans').attr('class','header plans').addClass($(this).data('value').toLowerCase());let currentLevel=_levels[$(this).data('group-id')];$('#tableCalculateCompare .calculate--levels').html('<div class="item"> <div class="ui--label active" data-number="'+currentLevel.number+'"> <span class="label">'+currentLevel.label+'</span> </div> </div>');$.each(currentLevel.levels,function(index,element){$('#tableCalculateCompare .calculate--levels').append('<div class="item"> <div class="ui--label" data-number="'+element.number+'"> <span class="label">'+element.label+'</span> </div> </div>');});_calculate_table('tableCalculateCompare');});$('body').on('click','#tableCalculate .calculate--levels [data-number]',function(){$('#tableCalculate [data-number]').removeClass('active');$(this).addClass('active');_calculate_table();});$('body').on('click','#tableCalculateCompare .calculate--levels [data-number]',function(){$('#tableCalculateCompare [data-number]').removeClass('active');$(this).addClass('active');_calculate_table('tableCalculateCompare');});$('body').on('click','.calculate-body',function(){$('.calculate--select').removeClass('open');});$('body').on('change keyup','.profit-calculate select, .profit-calculate input',function(){_calculate_profit();});$('body').on('change','#tableCalculate #currency_id',function(){_calculate_table();});$('body').on('change','#tableCalculateCompare #compare_currency_id',function(){_calculate_table('tableCalculateCompare');});$('body').on('click','.toggle--compare',function(){$('.toggle--compare').toggleClass('active');$('#toggleCompare').toggleClass('hide');});if(_calculate_data!==null){_calculate_profit();_calculate_table();_calculate_table('tableCalculateCompare');}});